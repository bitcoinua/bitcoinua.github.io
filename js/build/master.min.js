var BITCOIN=BITCOIN||{};BITCOIN.AjaxLoad=function(){return{loadData:function(id,callback,urlPrefix,urlSuffix){var urlPrefix=urlPrefix||BITCOIN.dataSourceURL+"data/";var urlSuffix=urlSuffix||".json";var id=id;BITCOIN.AjaxManager.add(id,$.ajax({crossDomain:true,cache:false,type:"GET",dataType:"json",url:urlPrefix+id+urlSuffix,success:function(data){callback(id.split("-")[0],data)}}))}}}();BITCOIN.AjaxManager=function(){this.ajaxRequests=[];function add(id,xhr){if(this.ajaxRequests[id]){this.ajaxRequests[id].abort()}this.ajaxRequests[id]=xhr}return{add:function(id,xhr){add(id,xhr)}}}();(function(){var namespace=MAIN.namespace("MAIN.app");if(namespace.Ticker===undefined){namespace.Ticker=function(){};var p=namespace.Ticker.prototype;p.interval=30000;p.init=function($domEl){this.$domEl=$domEl;this.field=this.$domEl.attr("data-type");this.dataRecievedBound=this.dataRecieved.bind(this);this.getDataBound=this.getData.bind(this);this.getData(true)};p.getData=function(onceOnly){$.ajax({crossDomain:true,cache:false,type:"GET",dataType:"json",url:BITCOIN.dataSourceURL+"stats.php?c="+this.field,success:function(data){this.dataRecievedBound(data)}.bind(this)});this.cancelTimeout();if(!onceOnly){this.timeout=setTimeout(this.getDataBound,this.interval)}};p.cancelTimeout=function(){if(this.timeout){clearTimeout(this.timeout)}};p.dataRecieved=function(data){var now=data[0][this.field];var diff=now-data[1][this.field];if(diff>0){$(".ticker-arrow img",this.$domEl).removeClass("down")}else{$(".ticker-arrow img",this.$domEl).addClass("down")}$(".ticker-number",this.$domEl).text(now)};p.toString=function(){return"Ticker"}}})();(function(){var namespace=MAIN.namespace("MAIN.app");if(namespace.Graph===undefined){namespace.Graph=function(){};var p=namespace.Graph.prototype;p.props=null;p.paper=null;p.init=function(name,type,dataChannels,domEl,props){var defaultProps={width:468,height:353,axisYValues:10,axisXValues:5,useRaphael:true};this.props=RHYTHM.Utils.Tools.mergeObject(defaultProps,props);this.name=name;this.type=type;this.dataChannels=dataChannels.split(",");this.filter="month";this.data=[];this.$domEl=domEl;this.spinner=$(".spinner",this.$domEl.closest(".graph-holder"));if(this.props.useRaphael){this.initRaphael(this.props.width,this.props.height)}$(window).resize(this.onResize.bind(this));$(window).resize();RHYTHM.TriggerInView.createTriggerId(this.$domEl);this.register()};p.register=function(){RHYTHM.TriggerInView.registerDomElement(this.$domEl.attr("data-trigger-id"),this.onScreen.bind(this),this.offScreen.bind(this),0.2,0.2)};p.onScreen=function(){var a=$("ul li a[data-filter='"+this.filter+"']",this.$domEl);a.trigger("click")};p.offScreen=function(){this.clearGraph();this.clearNav()};p.clearNav=function(){var aList=$("ul li a",this.$domEl).each(function(id,el){$(el).removeClass("selected")})};p.initRaphael=function(){this.paper=new Raphael(this.name+"-canvas",this.props.width,this.props.height);this.elements=this.paper.set()};p.changeFilter=function(filter){this.filter=filter;this.clearGraph();this.setGraphLoading();this.dataChannelsResponded=0;for(var i=0;i<this.dataChannels.length;++i){BITCOIN.AjaxLoad.loadData(this.dataChannels[i]+"-"+filter,this.newDataRecieved.bind(this))}};p.clearGraph=function(){};p.setGraphLoading=function(){TweenMax.to(this.spinner,0.4,{autoAlpha:0.3,ease:Sine.easeIn})};p.newDataRecieved=function(id,data){this.dataChannelsResponded++;this.data[id]=data;if(this.dataChannelsResponded<this.dataChannels.length){return}this.setupGraphs();for(var i=this.dataChannels.length-1;i>-1;--i){this.redrawGraph(this.dataChannels[i])}TweenMax.to(this.spinner,0.1,{autoAlpha:0,ease:Sine.easeIn})};p.setupGraph=function(id){};p.redrawGraph=function(id){};p.onResize=function(e){};p.toString=function(){return"Graph"}}})();(function(){var namespace=MAIN.namespace("MAIN.app");if(namespace.BubbleGraph===undefined){namespace.BubbleGraph=function(){};namespace.BubbleGraph.prototype=new namespace.Graph;var p=namespace.BubbleGraph.prototype;p.initSuperGraph=p.init;p.animations=null;p.chart=null;p.init=function(name,type,dataChannels,domEl,props){var defaultProps={width:865,height:865,useRaphael:false};this.props=RHYTHM.Utils.Tools.mergeObject(defaultProps,props);this.initSuperGraph(name,type,dataChannels,domEl,this.props);this.animations=[];this.diameter=this.props.width;this.ratio=1;this.colours=["#182F6D","#1C3981","#1C4796","#1C4796","#385298","#4D5E98","#5E6897","#6A7093","#70748C","#727483"];this.updateContainerWidth()};p.register=function(){RHYTHM.TriggerInView.registerDomElement(this.$domEl.attr("data-trigger-id"),this.onScreen.bind(this),this.offScreen.bind(this),0.2,0.2)};p.onScreen=function(){this.getNewData()};p.offScreen=function(){for(var i=0;i<this.allCircles.length;++i){TweenMax.to(this.allCircles[i],0.3,{radius:0,opacity:0,onUpdate:this.updateCircle,onUpdateParams:[this.allCircles[i]],ease:Sine.easeOut})}};p.clearGraph=function(){$(".bubbleGraph",this.$domEl).remove();$(".market-volumes-key").empty()};p.getNewData=function(){this.clearGraph();this.setGraphLoading();this.dataChannelsResponded=0;BITCOIN.AjaxLoad.loadData(this.dataChannels[0],this.newDataRecieved.bind(this))};p.redrawGraph=function(){var format=d3.format(",d");var graph=d3.layout.pack().sort(null).size([this.diameter,this.diameter]).padding(7);this.drawBubbleGraph(graph,this.data)};p.setupGraphKey=function(){var x=15;var y=15;var maxRad=30;var r=0;for(var i=0;i<this.data.children.length;++i){r=RHYTHM.Utils.Tools.mapRange(i,0,10,15,8);var next="<div class='key-item'><div class='circle'><svg height='30' width='30'><circle cx='"+x+"' cy='"+y+"' r='"+r+"' stroke='none' fill='"+this.colours[i]+"' /></svg></div><p>"+this.data.children[i].symbol+" - $"+this.data.children[i].volume+"</p></div>";$(".market-volumes-key").append(next)}};p.drawBubbleGraph=function(graph,json){var classes=[];var childNodes=json.children;childNodes.forEach(function(c){classes.push({packageName:json.name,className:c.symbol,value:c.volume})});childClasses={children:classes};var svg=d3.select("#market-volumes").append("svg").attr("width",this.diameter).attr("height",this.diameter).attr("class","bubbleGraph").attr("viewBox","0 0 "+this.diameter+" "+this.diameter).attr("preserveAspectRatio","xMidYMid");this.chart=$(".bubbleGraph");var node=svg.selectAll(".node").data(graph.nodes(childClasses).filter(function(d){return !d.children})).enter().append("g").attr("class","node").attr("transform",function(d){return"translate("+d.x+","+d.y+")"});var c=node.append("circle").attr("r",function(d){return d.r});var t=node.append("text").attr("dy",".3em").style("text-anchor","middle").style("fill","#fff").text(function(d){return d.className.substring(0,d.r/3)});this.allCircles=[];var numCirlces=c[0].length;var j=0;for(var i=0;i<numCirlces;++i){var circle=c[0][i];var label=t[0][i];var circleObj={circle:circle,radius:0,opacity:0,label:label,labelOpacity:0};this.allCircles.push(circleObj);fontSize=RHYTHM.Utils.Tools.mapRange(i,0,numCirlces,24,9);$(label).attr("font-size",parseInt(fontSize)+"px");$(label).attr("font-family","'Open Sans'");var tr=parseFloat($(circle).attr("r"),10);$(circle).attr("r",circleObj.radius);circle.style.fill=this.colours[i];this.updateCircle(circleObj);var d=0.1;TweenMax.to(circleObj,0.2*(j+1+0.3),{delay:d,radius:tr,opacity:1,onUpdate:this.updateCircle,onUpdateParams:[circleObj],ease:Expo.easeInOut});j++}this.onResize()};p.updateContainerWidth=function(){var newW=Math.min(850,window.innerWidth*0.9);$("#market-volumes").width(newW);$("#market-volumes").height(newW)};p.onResize=function(){this.updateContainerWidth();if(this.chart){var targetWidth=this.$domEl.width();this.chart.attr("width",targetWidth);this.chart.attr("height",targetWidth)}};p.updateCircle=function(c){$(c.circle).attr("r",c.radius);c.circle.style.opacity=c.opacity};p.newDataRecieved=function(id,data){this.data=data;this.setupGraph();this.redrawGraph();this.setupGraphKey()};p.toString=function(){return"BubbleGraph"}}})();(function(){var namespace=MAIN.namespace("MAIN.app");if(namespace.PulseGraph===undefined){namespace.PulseGraph=function(){};namespace.PulseGraph.prototype=new namespace.Graph;var p=namespace.PulseGraph.prototype;p.initSuperGraph=p.init;p.animations=null;p.gridLayout=null;p.init=function(name,type,dataChannels,domEl,props){var defaultProps={axisYValues:6,axisXValues:2};this.props=RHYTHM.Utils.Tools.mergeObject(defaultProps,props);this.initSuperGraph(name,type,dataChannels,domEl,this.props);this.animations=[];this.graphLayout={strokeWidth:1,graphX:87,graphY:35,graphWidth:366,graphHeight:267};this.clearGraph()};p.clearGraph=function(){if(this.animations){for(var i=0;i<this.dataChannels.length;++i){if(this.animations[this.dataChannels[i]]){this.animations[this.dataChannels[i]].cancel()}}}TweenMax.killTweensOf(this);this.paper.clear();this.xVals=[];this.yVals=[];this.yAxisVals=[];this.drawOuterRect()};p.redrawGraph=function(id){this.initPulseGraph(id,{colors:["#1C4796"],shade:false});this.animateGraphs()};p.processNewData=function(id){var values=[];for(var i=0;i<this.data[id].values.length;++i){this.data[id].values[i].x*=1000;values.push(this.data[id].values[i])}values=values.sort(function(a,b){return a.x-b.x});this.graphX=this.graphLayout.graphX;this.graphY=this.graphLayout.graphY;this.graphWidth=this.graphLayout.graphWidth;this.graphHeight=this.graphLayout.graphHeight;this.xVals[id]=[];this.yVals[id]=[];this.yAxisVals[id]=[];for(var j=0;j<values.length;++j){this.xVals[id].push(values[j].x);this.yVals[id].push(values[j].y)}this.yAxisVals[id]=this.getRoundedAxisValues(this.yVals[id],id)};p.getAxisLabelItems=function(array,amount){newArray=MinMax.getEvenlySpacedArray(0,array.length,amount,0);newArray[0]=0;newArray[newArray.length-1]=array.length-1;return newArray};p.setupGraphs=function(){var nextID;var dataObjects=[];for(var i=0;i<this.dataChannels.length;++i){nextID=this.dataChannels[i];this.processNewData(nextID);dataObjects.push(this.yAxisVals[nextID])}this.setupXAxis(this.data[nextID].values);this.setupYAxis(dataObjects);this.addTitles(this.$domEl.attr("data-titles").split(","))};p.addTitles=function(titles){var dualAxis=titles.length>1;for(var i=0;i<titles.length;++i){if(dualAxis){var dualAxisTitleY=this.graphY-35;if(i==0){this.addLabel(this.graphX-10,dualAxisTitleY,titles[i],"left",16,"#1C4796")}else{this.addLabel(this.graphX+this.graphWidth+10,dualAxisTitleY,titles[i],"right",16,"#2E3645")}}else{this.addLabel(this.graphX-10,this.graphY-25,titles[i],"left",15,"#C6C6C5")}}};p.setupXAxis=function(values){var lower=values[0].x;var upper=values[values.length-1].x;var timestamps=MinMax.getEvenlySpacedArray(lower,upper,this.props.axisXValues,0);var xAxisLabels=this.filter=="day"?this.getHoursFromTimestamps(timestamps):this.getDatesFromTimestamps(timestamps);var step=this.graphWidth/(xAxisLabels.length-1);for(var i=0;i<xAxisLabels.length;++i){var align="center";if(this.type=="pulse"&&i==0){align="right"}else{if(this.type=="pulse"&&i==xAxisLabels.length-1){align="left"}}this.addLabel(this.graphX+step*i,this.graphY+this.graphHeight+20,xAxisLabels[i],align,15,"#C6C6C5")}};p.setupYAxis=function(dataObjects){for(var i=0;i<dataObjects.length;++i){var axisLabels=this.yAxisVals;if(i==0){this.drawGrid(this.props.axisYValues-1);this.drawYLabels(axisLabels[this.dataChannels[i]],"left","#1C4796")}else{this.drawYLabels(axisLabels[this.dataChannels[i]],"right","#2E3645")}}};p.getDatesFromTimestamps=function(timestamps){var dates=[];for(var i=0;i<timestamps.length;++i){var d=new Date(timestamps[i]);dates.push(d.getDate()+" "+this.getMonth(d.getMonth())+" "+d.getFullYear())}return dates};p.getHoursFromTimestamps=function(timestamps){var times=[];var hoursteps=timestamps.length==2?["24"]:["24","18","12","6"];for(var i=0;i<timestamps.length;++i){if(i==timestamps.length-1){times.push("Now")}else{times.push("-"+hoursteps[i]+" hrs")}}return times};p.getMonth=function(month){var months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];return months[month]};p.sortYValues=function(data){return data.sort(function(a,b){return a.y-b.y})};p.drawOuterRect=function(){var x=this.graphLayout.graphX,y=this.graphLayout.graphY,w=this.graphLayout.graphWidth,h=this.graphLayout.graphHeight;var pathOutline=["M"+x+","+y+"L"+(x+w)+","+y+"L"+(x+w)+","+(y+h)+"L"+x+","+(y+h)+"L"+x+","+y];this.paper.path(pathOutline).attr({stroke:"#C6C6C5","stroke-width":0.75})};p.drawGrid=function(numRows){var gridLayout=[];var x=this.graphLayout.graphX,y=this.graphLayout.graphY,w=this.graphLayout.graphWidth,h=this.graphLayout.graphHeight;var step=h/numRows;var startY=y+h;var pathInnerLines=[];for(var i=1;i<numRows;++i){var nY=Math.floor(startY-step*i);pathInnerLines=pathInnerLines.concat(["M"+x+","+nY+"L"+(x+w)+","+nY])}this.paper.path(pathInnerLines).attr({stroke:"#C6C6C5","stroke-width":0.5,"stroke-opacity":0.3,fill:"none","fill-opacity":0})};p.drawYLabels=function(graphValues,pos,col){var x=this.graphLayout.graphX,y=this.graphLayout.graphY,w=this.graphLayout.graphWidth,h=this.graphLayout.graphHeight;var step=h/(graphValues.length-1);var startY=y+h-step;for(var i=0;i<graphValues.length;++i){var valueY=graphValues[i];var nY=startY-step*(i-1);var nX=pos=="left"?x-10:x+w+10;if(i>0){this.addLabel(nX,nY,valueY,pos,15,col)}}};p.addLabel=function(x,y,str,anchor,size,color){var lbl=this.paper.text(x,y,str);var align=anchor=="left"?"end":"start";align=anchor=="center"?"middle":align;lbl.attr({"text-anchor":align,"font-size":size,"font-family":"Open Sans",fill:color});return lbl};p.initPulseGraph=function(id,props){props.colors.push("transparent");var valuesX=this.xVals[id];var valuesY=this.yVals[id];var valuesYBounds=this.yAxisVals[id];if(!this.charts){this.charts=[]}var c=this.drawPulseGraph(this.xVals[id],this.yVals[id],valuesYBounds,props);this.charts.push(c);c.clipRectWidth=0;this.setClipRectWidth(c)};p.drawPulseGraph=function(xVals,yVals,yValBounds,props){var smallestTime;var largestTime;var smallestVal;var largestVal;for(var i=0;i<yVals.length;++i){if(smallestVal===undefined){smallestVal=yVals[i]}else{if(smallestVal>yVals[i]){smallestVal=yVals[i]}}if(largestVal===undefined){largestVal=yVals[i]}else{if(largestVal<yVals[i]){largestVal=yVals[i]}}}smallestTime=xVals[0];largestTime=xVals[xVals.length-1];var lowerBound=yValBounds[0];var upperBound=yValBounds[yValBounds.length-1];var gx=this.graphLayout.graphX,gy=this.graphLayout.graphY,gw=this.graphLayout.graphWidth,gh=this.graphLayout.graphHeight;var offsetY=gy+gh;var prevX;var prevY;var firstY;function mt(x,y){return"M"+x+","+(offsetY-y)}function lt(x,y){return"L"+x+","+(offsetY-y)}var path="";path+=mt(gx,gy);for(var j=0;j<yVals.length;++j){var x=RHYTHM.Utils.Tools.mapRange(xVals[j],smallestTime,largestTime,gx,gx+gw);var y=RHYTHM.Utils.Tools.mapRange(yVals[j],lowerBound,upperBound,0,gh);if(j==0){firstY=y}if(!prevX){path+=mt(x,y)}else{path+=lt(x,y)}prevX=x;prevY=y}if(props.shade){path+=lt(prevX,0);path+=lt(gx,0);path+=lt(gx,firstY)}var p=this.paper.path(path);if(props.shade){p.attr({fill:props.colors[0],stroke:"none","fill-opacity":1});p.toBack()}else{p.attr({stroke:props.colors[0],"stroke-width":this.graphLayout.strokeWidth});p.toFront()}return p};p.getRoundedAxisValues=function(values,id){var newVals=values.slice().sort(function(a,b){return a-b});var roundTo=this.getDigitsToRound(String(Math.round(newVals[newVals.length-1])).length);var largestValue=Math.ceil(newVals[newVals.length-1]/roundTo)*roundTo;var smallestValue=Math.floor(newVals[0]/roundTo)*roundTo;var numLabels=this.props.axisYValues;var vals=MinMax.getEvenlySpacedArray(smallestValue,largestValue,numLabels);vals=this.roundAllNumbers(vals,roundTo);return vals};p.getDigitsToRound=function(digitCount){digitCount=Math.max(0,digitCount-3);var zeros="";for(var i=0;i<digitCount;++i){zeros+="0"}var result=Number("1"+zeros);return result};p.roundAllNumbers=function(vals,roundTo){for(var i=0;i<vals.length;++i){vals[i]=Math.ceil(vals[i]/roundTo)*roundTo}return vals};p.animateGraphs=function(){for(var i=0;i<this.charts.length;++i){TweenLite.to(this.charts[i],2,{clipRectWidth:this.graphWidth,onUpdate:this.setClipRectWidth.bind(this),onUpdateParams:[this.charts[i]],ease:Circ.easeOut})}};p.setClipRectWidth=function(chart){chart.attr({"clip-rect":this.graphX+" "+this.graphY+" "+chart.clipRectWidth+" "+this.graphHeight})};p.getDateString=function(ms){var d=new Date(ms);return d.toUTCString()};p.toString=function(){return"PulseGraph"}}})();(function(){var namespace=MAIN.namespace("MAIN.app");if(namespace.PriceTradingGraph===undefined){namespace.PriceTradingGraph=function(){};namespace.PriceTradingGraph.prototype=new namespace.PulseGraph;var p=namespace.PriceTradingGraph.prototype;p.initSuperPulseGraph=p.init;p.init=function(name,type,dataChannels,domEl,props){var defaultProps={axisYValues:10,axisXValues:5,width:1020,height:573};this.props=RHYTHM.Utils.Tools.mergeObject(defaultProps,props);this.initSuperPulseGraph(name,type,dataChannels,domEl,this.props);this.graphLayout={strokeWidth:2,graphX:146,graphY:43,graphWidth:689,graphHeight:500};this.clearGraph()};p.redrawGraph=function(id){if(id.indexOf("marketprice")!==-1){this.initPulseGraph(id,{colors:["#1C4796"],shade:false});this.graphLayout.stroke=2}else{this.graphLayout.stroke=1;this.initPulseGraph(id,{colors:["#DFDEE2"],shade:true,nostroke:true})}this.animateGraphs()};p.onResize=function(){var smallSize=500;var bigSize=this.props.width;var ratio=this.props.height/this.props.width;this.paper.setSize(Math.min(bigSize,this.$domEl.width()),Math.min(bigSize,this.$domEl.width())*ratio,true,false);this.paper.setViewBox(0,0,this.props.width,this.props.height,true)};p.toString=function(){return"PriceTradingGraph"}}})();(function(){var namespace=MAIN.namespace("MAIN.app");if(namespace.BitcoinStoryItem===undefined){namespace.BitcoinStoryItem=function(){};var p=namespace.BitcoinStoryItem.prototype;p.listeninig;p.init=function(id,$domEl){this.id=id;this.$domEl=$domEl;this.listeninig=false;this.leftPane=$(".story-left",this.$domEl);this.centerPane=$(".story-center",this.$domEl);this.rightPane=$(".story-right",this.$domEl)};p.register=function(){RHYTHM.TriggerInView.registerDomElement(this.$domEl.attr("data-trigger-id"),this.onScreen.bind(this),this.offScreen.bind(this),-0.2,-0.2)};p.setPosition=function(){var winTop=$(window).scrollTop();var myTop=this.$domEl.offset().top;var winHeight=window.innerHeight;var perc=(myTop-winTop)/winHeight;var mapPerc=1-Math.abs(RHYTHM.Utils.Tools.mapRange(perc,0,1,-1,1));var alpha=RHYTHM.Utils.Tools.mapRange(mapPerc,0,1,0.2,1);var scale=RHYTHM.Utils.Tools.mapRange(mapPerc,0,1,0.6,1.1);TweenMax.to(this.leftPane,0.01,{alpha:alpha,scaleX:scale,scaleY:scale,ease:Quad.easeOut,overwrite:2,transformOrigin:"100% 50%"});TweenMax.to(this.centerPane,0.01,{alpha:alpha,scaleX:scale,scaleY:scale,ease:Quad.easeOut,overwrite:2,transformOrigin:"50% 50%"});TweenMax.to(this.rightPane,0.01,{alpha:alpha,scaleX:scale,scaleY:scale,ease:Quad.easeOut,overwrite:2,transformOrigin:"0% 50%"})};p.resetTransforms=function(){this.resetTransform(this.leftPane);this.resetTransform(this.centerPane);this.resetTransform(this.rightPane)};p.resetTransform=function(div){div.css("transform","none");div.css("-webkit-transform","none");div.css("-moz-transform","none");div.css("-o-transform","none");div.css("-ms-transform","none");TweenMax.to(div,0,{immediateRender:true,alpha:1,ease:Quad.easeOut,overwrite:2})};p.onScreen=function(){this.listeninig=true};p.offScreen=function(){this.listeninig=false};p.toString=function(){return"BitcoinStoryItem"}}})();(function(){var namespace=MAIN.namespace("MAIN.app");if(namespace.BitcoinStory===undefined){namespace.BitcoinStory=function(){};var p=namespace.BitcoinStory.prototype;p.currentScale=1;p.initialHeight=0;p.data=[{date:"OCT 31 2008",copy:"<a href='invented.html' target='_blank'>Satoshi Nakamoto</a> publishes Paper on Bitcoin",value:"0"},{date:"JAN 01 2009",copy:"First block mined",value:"0"},{date:"MAY 22 2010",copy:"First transaction for tangible goods: ‘Laszlo’ buys a pizza for 10,000 BTC",value:"0"},{date:"JUL 18 2010",copy:"Major BTC exchange MtGox opens",value:"0"},{date:"MAY 2011",copy:"Foundation of BTC payment service provider BitPay",value:"9"},{date:"JUN 10 2011",copy:"Height of the first BTC ‘bubble’ – first <a href='risks.html' target='_blank'>legal concerns</a>",value:"35"},{date:"SEP 11 2013",copy:"Number of merchants accepting BTC exceeds 1,000",value:"11"},{date:"MAR 28 2013",copy:"BTC market cap. surpasses USD 1 billion",value:"91.5"},{date:"OCT 02 2013",copy:"FBI shuts down Silk Road, seizes colossal amount of BTC",value:"128"},{date:"OCT 29 2013",copy:"First Bitcoin ATM starts operation in Vancouver",value:"209"},{date:"NOV 18 2013",copy:"US Senate holds hearing on Bitcoin",value:"579"},{date:"NOV 30 2013",copy:"BTC market cap. exceeds USD 14.4 billion",value:"1,203"},{date:"DEC 11 2013",copy:"Number of merchants accepting BTC exceeds 15,000",value:"979"}];p.items=null;p.init=function($domEl){this.$domEl=$domEl;this.items=[];var onScreenBound=this.onScreen.bind(this);var offScreenBound=this.offScreen.bind(this);var storyHTML=$("<div>").append($(".scroll-item").clone()).html();$(".scroll-item").remove();for(var i=0;i<this.data.length;++i){var next=$(storyHTML);$(".story-date",next).text(this.data[i].date);$(".story-body",next).html(this.data[i].copy);$(".story-value",next).text(this.data[i].value);this.$domEl.append(next);var item=new namespace.BitcoinStoryItem;item.init(i,next);this.items.push(item)}RHYTHM.TriggerInView.createGroupTriggerId($(".scroll-item",this.$domEl));for(var j=0;j<this.items.length;++j){this.items[j].register()}this.initialHeight=$(".story-scroll").height();this.onScrollBound=this.onScroll.bind(this);this.onResizeBound=this.onResize.bind(this);$(window).scroll(this.onScrollBound);$(window).resize(this.onResizeBound);$(window).resize();$(window).scroll()};p.onScroll=function(){this.updateScale();if(this.currentScale>=1){for(var j=0;j<this.items.length;++j){if(this.items[j].listeninig&&Modernizr.touch==false){this.items[j].setPosition()}}}this.setGlobalScale()};p.onResize=function(){this.updateScale();if(this.currentScale>=1&&Modernizr.touch==false){for(var j=0;j<this.items.length;++j){this.items[j].setPosition()}}this.setGlobalScale()};p.updateScale=function(){this.currentScale=Math.min(window.innerWidth/660*0.8,1)};p.setGlobalScale=function(){if(this.currentScale<1){for(var j=0;j<this.items.length;++j){this.items[j].resetTransforms()}TweenMax.to($(".story-scroll"),0,{immediateRender:true,scaleX:this.currentScale,scaleY:this.currentScale,ease:Quad.easeOut,overwrite:2,transformOrigin:"50% 0%"});$(".story-scroll").height(this.initialHeight*this.currentScale)}$(".story-scroll").css("background-size","680px "+window.innerHeight+"px")};p.onScreen=function(el){console.log("on: "+el.id)};p.offScreen=function(el){console.log("off: "+el.id)};p.toString=function(){return"BitcoinStory"}}})();var RHYTHM=RHYTHM||{};RHYTHM.TriggerInView=function(){this.name="TriggerInView ::";this.initialised=false;this.listenObjects=[];this.nextId=0;this.init=function(header){this.header=header;if(this.initialised){return}this.initialised=true;$(window).scroll(this.update.bind(this))};this.createTriggerId=function(selector){$(selector).attr("data-trigger-id",this.nextId);this.nextId++};this.createGroupTriggerId=function(selector){$.each($(selector),function(i,html){$(html).attr("data-trigger-id",this.nextId);this.nextId++}.bind(this))};this.registerDomElement=function(triggerId,onScreenCallback,offScreenCallback,topPerc,bottomPerc){var topPerc=topPerc||0;var bottomPerc=bottomPerc||0;this.listenObjects.push({triggerId:triggerId,onScreenCallback:onScreenCallback,offScreenCallback:offScreenCallback,topPerc:topPerc,bottomPerc:bottomPerc,onScreen:false})};this.update=function(){this.scrollTop=$(window).scrollTop();this.windowHeight=$(window).innerHeight();this.headerOffset=0;if(this.header!=undefined){this.headerOffset=$(this.header).height()}var position;for(var i in this.listenObjects){position=this.getPosition(this.listenObjects[i]);this.trigger(position,this.listenObjects[i])}};this.getPosition=function(obj){var element=$("*[data-trigger-id='"+obj.triggerId+"']");var y=element.offset().top;var offTop=y+element.height()<this.scrollTop+this.headerOffset+this.windowHeight*obj.topPerc;var offBottom=this.scrollTop+this.windowHeight-this.windowHeight*obj.bottomPerc<y;return{offTop:offTop,offBottom:offBottom}};this.trigger=function(position,obj,force){var force=force||false;if(position.offTop||position.offBottom){if(obj.onScreen==true||force){obj.offScreenCallback(obj.triggerId)}obj.onScreen=false}else{if(obj.onScreen==false||force){obj.onScreenCallback(obj.triggerId)}obj.onScreen=true}};this.checkInView=function(triggerId){var obj;for(var i=0;i<this.listenObjects.length;++i){if(this.listenObjects[i].triggerId==triggerId){obj=this.listenObjects[i];break}}var position=this.getPosition(this.listenObjects[i]);this.trigger(position,this.listenObjects[i],false)};this.objects=function(){return this.listenObjects};return{init:this.init.bind(this),registerDomElement:this.registerDomElement.bind(this),update:this.update.bind(this),checkInView:this.checkInView.bind(this),createGroupTriggerId:this.createGroupTriggerId.bind(this),createTriggerId:this.createTriggerId.bind(this),objects:this.objects.bind(this)}}();(function(){var namespace=MAIN.namespace("MAIN.app");if(namespace.ParallaxController===undefined){namespace.ParallaxController=function(){};var p=namespace.ParallaxController.prototype;p.init=function(){this.items=[];this.lastScrollTop=0;$(window).scroll(this.onScrollPage.bind(this));this.onScrollPage()};p.addItem=function(item){item.bgY=0;item.onScreen=false;RHYTHM.TriggerInView.createTriggerId(item.selector);RHYTHM.TriggerInView.registerDomElement($(item.selector).attr("data-trigger-id"),this.onScreen.bind(this),this.offScreen.bind(this));this.items.push(item)};p.onScreen=function(triggerId){for(var i in this.items){if($(this.items[i].selector).attr("data-trigger-id")==triggerId){this.items[i].onScreen=true;break}}};p.offScreen=function(triggerId){for(var i in this.items){if($(this.items[i].selector).attr("data-trigger-id")==triggerId){this.items[i].onScreen=false;break}}};p.onScrollPage=function(scrollTop){this.scrollTop=$(window).scrollTop();this.scrollSpeed=this.scrollTop-this.lastScrollTop;this.lastScrollTop=this.scrollTop;if(Modernizr.touch==false){for(var i=0;i<this.items.length;++i){var item=this.items[i];if(item.onScreen){item.bgY-=this.scrollSpeed*(item.speed-1);$(item.selector).css("background-position","center "+item.bgY+"px")}}}}}})();(function(){var namespace=MAIN.namespace("MAIN.app");if(namespace.FontController===undefined){namespace.FontController=function(){};var p=namespace.FontController.prototype;p.init=function(){this.containers=[];$(window).resize(this.onResize.bind(this))};p.addContainer=function(selector){this.containers.push(selector);$(window).resize()};p.onResize=function(e){for(var i in this.containers){var maxWidth=parseInt($(this.containers[i]).css("max-width"));var actualWidth=$(this.containers[i]).width();var perc=actualWidth/maxWidth*100;$(this.containers[i]+" .font16").css("font-size",perc+"%");$(this.containers[i]+" .font13").css("font-size",perc*(13/16)+"%");$(this.containers[i]+" .font14").css("font-size",perc*(14/16)+"%");$(this.containers[i]+" .font18").css("font-size",perc*(18/16)+"%");$(this.containers[i]+" .font21").css("font-size",perc*(21/16)+"%");$(this.containers[i]+" .font22").css("font-size",perc*(22/16)+"%")}}}})();(function(){var namespace=MAIN.namespace("MAIN.app");if(namespace.BitcoinMain===undefined){namespace.BitcoinMain=function(){};var p=namespace.BitcoinMain.prototype;this.graphs=null;this.graphLookup=null;this.data=null;p.init=function(externalPage){this.detectDevice();RHYTHM.TriggerInView.init("#nav-bar");this.data=[];this.graphLookup=[];if(!externalPage){this.anchorFix();this.initEventListeners();this.initGraphs();this.initTickers();this.initBitcoinStory();this.initParallax();this.initNavBoxes();this.initFontController()}else{if(externalPage=="charts"){this.initEventListeners();this.initGraphs();this.initTickers();$(window).scroll()}}var t=new namespace.Ticker;t.init($(".ticker-nav"))};p.initNavBoxes=function(){RHYTHM.TriggerInView.createTriggerId($("#section-nav-container"));RHYTHM.TriggerInView.registerDomElement($("#section-nav-container").attr("data-trigger-id"),this.showNavBoxes.bind(this),this.hideNavBoxes.bind(this),0,0.2);this.navBoxesDelay=1;this.hideNavBoxes();this.showNavBoxes()};p.hideNavBoxes=function(){var scale=0.1;TweenMax.set("#section-nav",{perspective:400});TweenMax.killTweensOf(".section-nav-box.what-button");TweenMax.killTweensOf(".section-nav-box.story-button");TweenMax.killTweensOf(".section-nav-box.today-button");TweenMax.to(".section-nav-box.what-button",0,{autoAlpha:0,scale:scale,rotationY:180,overwrite:3});TweenMax.to(".section-nav-box.story-button",0,{autoAlpha:0,scale:scale,rotationY:180,overwrite:3});TweenMax.to(".section-nav-box.today-button",0,{autoAlpha:0,scale:scale,rotationY:180,overwrite:3});TweenMax.killTweensOf("#scroll-down-arrow");TweenMax.killTweensOf("#scroll-down");TweenMax.to("#scroll-down-arrow",0,{autoAlpha:0,y:-60,overwrite:3});TweenMax.to("#scroll-down",0,{autoAlpha:0,y:-60,overwrite:3})};p.showNavBoxes=function(){var delay=this.navBoxesDelay;this.navBoxesDelay=0;var ease=Back.easeOut;this.hideNavBoxes();TweenMax.killTweensOf(".section-nav-box.what-button");TweenMax.killTweensOf(".section-nav-box.story-button");TweenMax.killTweensOf(".section-nav-box.today-button");TweenMax.to(".section-nav-box.what-button",0.4,{delay:delay+0.5,autoAlpha:1,ease:Sine.easeOut});TweenMax.to(".section-nav-box.what-button",0.6,{delay:delay+0.5,scale:1,rotationY:0,ease:ease});TweenMax.to(".section-nav-box.story-button",0.4,{delay:delay+0.7,autoAlpha:1,ease:Sine.easeOut});TweenMax.to(".section-nav-box.story-button",0.6,{delay:delay+0.7,scale:1,rotationY:0,ease:ease});TweenMax.to(".section-nav-box.today-button",0.4,{delay:delay+0.9,autoAlpha:1,ease:Sine.easeOut});TweenMax.to(".section-nav-box.today-button",0.6,{delay:delay+0.9,scale:1,rotationY:0,ease:ease});TweenMax.killTweensOf("#scroll-down-arrow");TweenMax.killTweensOf("#scroll-down");TweenMax.to("#scroll-down-arrow",0.7,{delay:delay+1.4,y:0,autoAlpha:1,ease:Sine.easeOut});TweenMax.to("#scroll-down",0.7,{delay:delay+1.8,y:0,autoAlpha:1,ease:Sine.easeOut})};p.bounceArrow=function(){var t=new TimelineMax({yoyo:true,repeat:-1});t.append(new TweenMax("#scroll-down-arrow",0.5,{y:0,ease:Sine.easeIn}));t.append(new TweenMax("#scroll-down-arrow",0.7,{y:-10,ease:Sine.easeOut}));t.play()};p.initFontController=function(){this.fontController=new namespace.FontController;this.fontController.init();this.fontController.addContainer("#use-container");this.fontController.addContainer("#currency-container");this.fontController.addContainer("#store-container");this.fontController.addContainer("#spend1-container");this.fontController.addContainer("#spend2-container");this.fontController.addContainer("#verification-container")};p.initParallax=function(){this.parallaxController=new namespace.ParallaxController;this.parallaxController.init();this.parallaxController.addItem({selector:"#b-parallax1",speed:0.5})};p.anchorFix=function(){var t=null;function getScrollY(){return window.pageYOffset!=null?window.pageYOffset:document.documentElement.scrollTop!=null?document.documentElement.scrollTop:document.body.scrollTop}$("a").click(function(e){if(this.href.lastIndexOf("#")!==-1){var anchor=this.href.substr(this.href.lastIndexOf("/")+1);if(anchor=="#"){return}var targDiv=$(anchor);var curScroll={x:0,y:getScrollY()};var targ=targDiv.offset().top;var time=Math.abs(curScroll.y-targ)/3000;t=TweenLite.to(curScroll,time,{y:targ,ease:Sine.easeOut,onUpdate:function(){window.scrollTo(curScroll.x,curScroll.y)}})}});$("body,html").bind("touchstart scroll mousedown wheel DOMMouseScroll mousewheel keyup",function(e){if(e.which>0||e.type=="mousedown"||e.type=="mousewheel"){if(t!=null){t.kill()}}})};p.initBitcoinStory=function(){this.story=new namespace.BitcoinStory;this.story.init($(".story-scroll"))};p.detectDevice=function(){var device=null;if(navigator.userAgent.match(/iPad/i)!=null){device="iPad"}else{if(navigator.userAgent.match(/iPhone/i)!=null||navigator.userAgent.match(/iPod/i)!=null){device="iPhone"}}var viewport=document.querySelector("meta[name=viewport]");switch(device){case"iPad":viewport.setAttribute("content","width=device-width; initial-scale=0.8; user-scalable=1;");break;case"iPhone":viewport.setAttribute("content","width=device-width; initial-scale=0.67; user-scalable=1;");break}};p.initEventListeners=function(){$(".graph ul li a").click(this.selectGraphFilter.bind(this))};p.selectGraphFilter=function(e){var t=$(e.target);var menuItems=$("ul li a",$(t.closest(".graph")[0]));var closestA=t.closest("li a");$(menuItems).not(closestA).removeClass("selected");$(closestA).toggleClass("selected");var graph=$(t.closest(".graph")[0]).attr("data-graph-id");this.graphLookup[graph].graph.changeFilter(t.attr("data-filter"));return false};p.initGraphs=function(){var graphs=$(".graph");this.graphs=[];for(var i=0;i<graphs.length;++i){this.createGraph($(graphs[i]))}};p.createGraph=function(domEl){var name=domEl.attr("data-graph-id");var type=domEl.attr("data-graph");var graph;var dataChannels=domEl.attr("data-channels");switch(name){case"market-volumes":graph=new namespace.BubbleGraph;break;case"pricetrading":graph=new namespace.PriceTradingGraph;break;case"transactions":graph=new namespace.PulseGraph;break;case"hashrate":graph=new namespace.PulseGraph;break}graph.init(name,type,dataChannels,domEl);graph.requestData=this.requestData.bind(this);var graphObj={name:name,type:type,graph:graph};this.graphLookup[name]=graphObj;this.graphs.push(graphObj)};p.initTickers=function(){var tickers=$(".ticker:not('.ticker-nav')");this.tickers=[];for(var i=0;i<tickers.length;++i){var t=new namespace.Ticker;t.init($(tickers[i]));this.tickers.push[t]}};p.requestData=function(id,graph){console.log("Requesting data for "+id+" / "+graph);console.log(id);this.data[id].request(id)};p.toString=function(){return"BitcoinMain"}}})();MAIN.init=function(){var app=MAIN.namespace("MAIN.app");var appManager=new app.BitcoinMain;appManager.init(window.bitcoinExternal)};$(function(){if(typeof(BITCOIN.dataSourceURL)==="undefined"||!BITCOIN.dataSourceURL){alert("Please configure the Bitcoin datasource")}MAIN.init()});
